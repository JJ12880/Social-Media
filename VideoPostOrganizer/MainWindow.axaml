<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vlc="clr-namespace:LibVLCSharp.Avalonia;assembly=LibVLCSharp.Avalonia"
        x:Class="VideoPostOrganizer.MainWindow"
        x:Name="Root"
        Title="Social Media Video Organizer"
        Width="1500"
        Height="860">
  <TabControl Margin="10">
    <TabItem Header="Library">
      <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
        <Grid RowDefinitions="Auto,*" ColumnDefinitions="*">
          <Grid Row="0" ColumnDefinitions="Auto,*,Auto,Auto" RowDefinitions="Auto,Auto">
            <TextBlock Text="Storage folders:" VerticalAlignment="Center" />
            <TextBox Grid.Column="1" Text="{Binding StorageFoldersText}" Margin="8,0,8,0" />
            <Button Grid.Column="2" Content="Load Storage" Click="OnLoadStorageClick" />
            <Button Grid.Column="3" Content="Rename All" Click="OnRenameAllFilesClick" Margin="8,0,0,0" />

            <TextBlock Grid.Row="1" Text="Source videos:" VerticalAlignment="Center" />
            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SourceFolderText}" Margin="8,0,8,0" />
            <Button Grid.Row="1" Grid.Column="2" Content="Browse" Click="OnBrowseSourceClick" Margin="0,0,8,0" />
            <StackPanel Grid.Row="1" Grid.Column="3" Orientation="Horizontal" Spacing="6">
              <Button Content="Import Videos" Click="OnImportClick" />
              <Button Content="Import IG Archive" Click="OnImportInstagramArchiveClick" />
            </StackPanel>
          </Grid>

          <Grid Grid.Row="1" Margin="0,10,0,0" ColumnDefinitions="2*,2*,*">
            <Grid Grid.Column="0" RowDefinitions="Auto,Auto,*" MinWidth="360">
              <TextBlock Text="Videos" FontWeight="Bold" />
              <Grid Grid.Row="1" ColumnDefinitions="*,Auto" Margin="0,8,0,0">
                <TextBox Grid.Column="0" Watermark="Search by video name" Text="{Binding SearchQuery}" />
                <Button Grid.Column="1" Margin="6,0,0,0" Content="X" Width="28" Height="28" Click="OnClearSearchClick" />
              </Grid>

              <Border Grid.Row="2" BorderThickness="1" BorderBrush="Gray" Margin="0,8,0,0">
                <Grid RowDefinitions="Auto,*">
                  <Grid Grid.Row="0" ColumnDefinitions="2*,*,*,Auto" Margin="8,6">
                    <Button Content="Name" HorizontalAlignment="Stretch" Click="OnSortByNameClick" />
                    <Button Grid.Column="1" Content="Performance" HorizontalAlignment="Stretch" Click="OnSortByPerformanceClick" />
                    <Button Grid.Column="2" Content="Created" HorizontalAlignment="Stretch" Click="OnSortByCreatedClick" />
                    <Button Grid.Column="3" Content="Ready" HorizontalAlignment="Stretch" Click="OnSortByReadyClick" />
                  </Grid>

                  <ListBox Grid.Row="1"
                           ItemsSource="{Binding Entries}"
                           SelectedItem="{Binding SelectedEntry}">
                    <ListBox.ItemTemplate>
                      <DataTemplate>
                        <Grid ColumnDefinitions="2*,*,*,Auto" Margin="8,4">
                          <TextBlock Text="{Binding VideoName}" />
                          <TextBlock Grid.Column="1" Text="{Binding PerformanceLevel}" />
                          <TextBlock Grid.Column="2" Text="{Binding FileCreatedDisplay}" />
                          <TextBlock Grid.Column="3" Text="{Binding ReadyForUse}" />
                        </Grid>
                      </DataTemplate>
                    </ListBox.ItemTemplate>

                    <ListBox.ContextMenu>
                      <ContextMenu>
                        <MenuItem Header="Rename selected" Click="OnRenameClick" />
                        <MenuItem Header="Delete selected" Click="OnDeleteClick" />
                        <MenuItem Header="Open in folder" Click="OnOpenInFolderClick" />
                      </ContextMenu>
                    </ListBox.ContextMenu>
                  </ListBox>
                </Grid>
              </Border>
            </Grid>

            <StackPanel Grid.Column="1" Spacing="8" MinWidth="420">
            <TextBlock Text="Video Preview" FontWeight="Bold" />
            <Border Height="240" BorderThickness="1" BorderBrush="Gray" Padding="4">
              <vlc:VideoView x:Name="VideoPreviewView" />
            </Border>
            <StackPanel Orientation="Horizontal" Spacing="8">
              <Button Content="{Binding PlayPauseButtonText}" Width="90" Click="OnPlayPauseClick" />
              <Button Content="Stop" Width="90" Click="OnStopClick" />
              <Button Content="Open Externally" Width="140" Click="OnOpenExternallyClick" />
            </StackPanel>
            <TextBlock TextWrapping="Wrap" Text="{Binding PreviewStatus}" />

            <StackPanel Orientation="Horizontal" Spacing="8">
              <TextBlock Text="Description file:" VerticalAlignment="Center" />
              <ComboBox Width="250"
                        ItemsSource="{Binding DescriptionFiles}"
                        SelectedItem="{Binding SelectedDescriptionFile}" />
              <Button Content="Add Description" Click="OnAddDescriptionClick" />
              <Button Content="Refresh Description" Click="OnRefreshDescriptionClick" />
            </StackPanel>

            <TextBox AcceptsReturn="True"
                     Height="147"
                     TextWrapping="WrapWithOverflow"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                     Text="{Binding DescriptionText}" 
					 MaxWidth ="600"/>

            <StackPanel Orientation="Horizontal" Spacing="8">
              <TextBlock Text="Tags:" VerticalAlignment="Center" />
              <TextBox Width="410" Text="{Binding TagsText}" />
            </StackPanel>

            <StackPanel Orientation="Horizontal" Spacing="10">
              <CheckBox Content="ready for use" IsChecked="{Binding ReadyForUse}" VerticalAlignment="Center" />
              <Button Content="{Binding SaveButtonText}" Width="160" Click="OnSaveClick" />
            </StackPanel>
          </StackPanel>

            <StackPanel Grid.Column="2" Spacing="8" Margin="12,0,0,0" MinWidth="320">
            <TextBlock Text="Hashtag Rule Engine" FontWeight="Bold" />
            <StackPanel Orientation="Horizontal" Spacing="8">
              <Button Content="Generate" Click="OnGenerateHashtagsClick" />
              <Button Content="Append" Click="OnAppendGeneratedHashtagsClick" />
            </StackPanel>
            <TextBox AcceptsReturn="True" IsReadOnly="True" Height="80" TextWrapping="Wrap" Text="{Binding GeneratedHashtagsText}" />

            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto">
              <TextBlock Text="Core count:" Margin="0,0,0,6" />
              <TextBox Grid.Column="1" Text="{Binding CoreCountText}" Margin="10,0,0,6" />
              <TextBlock Grid.Row="1" Text="Niche count:" Margin="0,0,0,6" />
              <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding NicheCountText}" Margin="10,0,0,6" />
              <TextBlock Grid.Row="2" Text="Test count:" Margin="0,0,0,6" />
              <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding TestCountText}" Margin="10,0,0,6" />
              <TextBlock Grid.Row="3" Text="Max tags:" Margin="0,0,0,6" />
              <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding MaxTagsText}" Margin="10,0,0,6" />
            </Grid>
            <StackPanel Orientation="Horizontal" Spacing="8">
              <TextBlock Text="Cooldown days:" VerticalAlignment="Center" />
              <TextBox Width="80" Text="{Binding CooldownDaysText}" />
              <Button Content="Save Rules" Click="OnSaveHashtagRulesClick" />
            </StackPanel>

            <Grid ColumnDefinitions="*,*,*">
              <StackPanel Grid.Column="0" Spacing="6">
                <TextBlock Text="Core hashtags" FontWeight="SemiBold" />
                <ListBox x:Name="CoreHashtagsList" Height="140" SelectionMode="Multiple" ItemsSource="{Binding CoreHashtags}">
                  <ListBox.ContextMenu>
                    <ContextMenu>
                      <MenuItem Header="Add hashtag" Click="OnAddCoreHashtagClick" />
                      <MenuItem Header="Remove selected" Click="OnRemoveCoreHashtagsClick" />
                    </ContextMenu>
                  </ListBox.ContextMenu>
                </ListBox>
              </StackPanel>
              <StackPanel Grid.Column="1" Spacing="6" Margin="10,0,0,0">
                <TextBlock Text="Niche hashtags" FontWeight="SemiBold" />
                <ListBox x:Name="NicheHashtagsList" Height="140" SelectionMode="Multiple" ItemsSource="{Binding NicheHashtags}">
                  <ListBox.ContextMenu>
                    <ContextMenu>
                      <MenuItem Header="Add hashtag" Click="OnAddNicheHashtagClick" />
                      <MenuItem Header="Remove selected" Click="OnRemoveNicheHashtagsClick" />
                    </ContextMenu>
                  </ListBox.ContextMenu>
                </ListBox>
              </StackPanel>
              <StackPanel Grid.Column="2" Spacing="6" Margin="10,0,0,0">
                <TextBlock Text="Test hashtags" FontWeight="SemiBold" />
                <ListBox x:Name="TestHashtagsList" Height="140" SelectionMode="Multiple" ItemsSource="{Binding TestHashtags}">
                  <ListBox.ContextMenu>
                    <ContextMenu>
                      <MenuItem Header="Add hashtag" Click="OnAddTestHashtagClick" />
                      <MenuItem Header="Remove selected" Click="OnRemoveTestHashtagsClick" />
                    </ContextMenu>
                  </ListBox.ContextMenu>
                </ListBox>
              </StackPanel>
            </Grid>

            <StackPanel Orientation="Horizontal" Spacing="10">
              <TextBlock Text="Performance:" VerticalAlignment="Center" />
              <ComboBox Width="140" ItemsSource="{Binding PerformanceLevels}" SelectedItem="{Binding PerformanceLevel}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="10">
              <TextBlock Text="Last post:" VerticalAlignment="Center" />
              <DatePicker SelectedDate="{Binding LastPostDate}" Width="150" />
            </StackPanel>
            </StackPanel>
          </Grid>
        </Grid>
      </ScrollViewer>
    </TabItem>

    <TabItem Header="Schedule">
      <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
        <Grid ColumnDefinitions="1.2*,*,1.1*" RowDefinitions="Auto,*" Margin="0,6,0,0">
          <Border Grid.ColumnSpan="3" BorderThickness="1" BorderBrush="Gray" Padding="8" Margin="0,0,0,8">
            <StackPanel Orientation="Horizontal" Spacing="10">
              <TextBlock Text="First Post Time (HH:mm):" VerticalAlignment="Center" />
              <TextBox Width="80" Text="{Binding FirstPostTime}" />
              <TextBlock Text="First subtype:" VerticalAlignment="Center" />
              <ComboBox Width="100" ItemsSource="{Binding PostSubtypes}" SelectedItem="{Binding FirstPostSubtype}" />
              <TextBlock Text="Repeat subtype:" VerticalAlignment="Center" />
              <ComboBox Width="100" ItemsSource="{Binding PostSubtypes}" SelectedItem="{Binding RepeatPostSubtype}" />
              <TextBlock Text="Repeat every (days):" VerticalAlignment="Center" />
              <TextBox Width="80" Text="{Binding RepeatEveryDaysText}" />
              <TextBlock Text="Repeat post time (HH:mm):" VerticalAlignment="Center" />
              <TextBox Width="80" Text="{Binding RepeatPostTime}" />
              <Button Content="Save settings" Click="OnSaveScheduleSettingsClick" />
            </StackPanel>
          </Border>

          <StackPanel Grid.Row="1" Grid.Column="0" Spacing="8">
            <TextBlock Text="Videos to schedule" FontWeight="Bold" />
            <ListBox x:Name="ScheduleVideoList" SelectionMode="Multiple" ItemsSource="{Binding ReadyEntries}">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <StackPanel Spacing="2">
                    <TextBlock Text="{Binding VideoName}" />
                    <TextBlock Text="{Binding PerformanceLevel, StringFormat=Quality: {0}}" FontSize="11" Opacity="0.75" />
                  </StackPanel>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </StackPanel>

          <StackPanel Grid.Row="1" Grid.Column="1" Spacing="8" Margin="10,0,10,0">
            <TextBlock Text="Calendar day planning" FontWeight="Bold" />
            <StackPanel Orientation="Horizontal" Spacing="8">
              <TextBlock Text="Target day:" VerticalAlignment="Center" />
              <DatePicker SelectedDate="{Binding SelectedScheduleDate}" Width="180" />
              <Button Content="Schedule selected videos" Click="OnScheduleSelectedVideosClick" />
            </StackPanel>
            <TextBlock Text="Tip: select multiple videos on the left, set repeat settings, then schedule them for the chosen day." TextWrapping="Wrap" />
            <ListBox ItemsSource="{Binding ScheduledPosts}">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <Grid ColumnDefinitions="170,100,100,*" Margin="4,2">
                    <TextBlock Text="{Binding ScheduledAtDisplay}" />
                    <TextBlock Grid.Column="1" Text="{Binding PostSubtype}" />
                    <TextBlock Grid.Column="2" Text="{Binding RepeatEveryDaysDisplay}" />
                    <TextBlock Grid.Column="3" Text="{Binding VideoName}" />
                  </Grid>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </StackPanel>

          <StackPanel Grid.Row="1" Grid.Column="2" Spacing="8">
            <TextBlock Text="Export" FontWeight="Bold" />
            <Button Content="Export Publer CSV" Click="OnExportPublerCsvClick" />
            <TextBlock TextWrapping="Wrap" Text="{Binding ScheduleStatus}" />
            <TextBlock Text="CSV columns: Date, Text, Link(s), Media URL(s), Title, Label(s), Alt text(s), Comment(s), Pin board/album/category, Post subtype, CTA, Reminder" TextWrapping="Wrap" FontSize="11" />
          </StackPanel>
        </Grid>
      </ScrollViewer>
    </TabItem>
  </TabControl>
</Window>
